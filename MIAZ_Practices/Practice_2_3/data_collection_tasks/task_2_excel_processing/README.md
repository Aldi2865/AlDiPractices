**Markdown**

```
# Filter Excel Data

Цей скрипт містить дві версії функцій для фільтрації даних в Excel-файлах:

1.  **Фільтрація за датою.**
2.  **Фільтрація за датою та значенням.**

## Вимоги

*   Python 3.6+
*   Бібліотеки:
    *   `pandas`
    *   `openpyxl`
    *   `python-dateutil`
    *   `pathlib`

Встановити необхідні бібліотеки можна за допомогою команди:

```bash
pip install pandas openpyxl python-dateutil pathlib
```

## Використання

### 1. Фільтрація за датою

Ця версія фільтрує дані в Excel-файлі за датою, залишаючи записи за вказану кількість місяців (за замовчуванням за останній місяць).

**Код функції знаходиться на початку файлу `filter_excel_data.py`**

**Налаштування:**

* Змініть при необхідності наступні змінні у функції `filter_excel_data` (перша версія функції):
  * `input_f_name`: Назва вхідного Excel-файлу (за замовчуванням `data.xlsx`).
  * `output_f_name`: Назва вихідного Excel-файлу (за замовчуванням `filtered_data.xlsx`).
  * `date_column`: Назва колонки з датами (за замовчуванням `Date`).
  * `condition_months`: Кількість місяців, за які будуть відібрані дані (за замовчуванням `1`).

**Запуск:**

* Запустіть скрипт `excel_processor.py` або `excel_processor_filtered.py`.

**Опис роботи:**

Функція виконує наступні дії:

1. Зчитує дані з Excel-файлу.
2. Визначає початкову та кінцеву дати для фільтрації.
3. Фільтрує дані за вказаний період.
4. Зберігає відфільтровані дані у новий Excel-файл.
5. Виводить повідомлення про успішне завершення або про помилки, якщо вони виникли.

### 2. Фільтрація за датою та значенням

Ця версія фільтрує дані в Excel-файлі за датою та додатково за значенням у вказаній колонці. Користувач вводить порогове значення та обирає тип фільтрації ("більші" чи "менші").

**Код функції знаходиться у другій частині файлу `filter_excel_data.py`**

**Налаштування:**

* Змініть при необхідності наступні змінні у функції `filter_excel_data` (друга версія функції):
  * `input_f_name`: Назва вхідного Excel-файлу (за замовчуванням `data.xlsx`).
  * `output_f_name`: Назва вихідного Excel-файлу (за замовчуванням `filtered_data.xlsx`).
  * `date_column`: Назва колонки з датами (за замовчуванням `Date`).
  * `value_column`: Назва колонки зі значеннями для фільтрації (за замовчуванням `Value`).
  * `condition_months`: Кількість місяців, за які будуть відібрані дані (за замовчуванням `3`).

**Запуск:**

* Запустіть скрипт `excel_processor_filtered.py`.
* Введіть порогове значення для фільтрації, коли з'явиться відповідний запит.
* Введіть `більші` або `менші`, щоб вказати, які значення (більші чи менші за порогове) потрібно вивести.

**Опис роботи:**

Функція виконує наступні дії:

1. Зчитує дані з Excel-файлу.
2. Фільтрує дані за вказаний період (за замовчуванням останні 3 місяці).
3. Запитує у користувача порогове значення та тип фільтрації ("більші" чи "менші").
4. Фільтрує дані за значенням у вказаній колонці відповідно до введених користувачем даних.
5. Зберігає відфільтровані дані у новий Excel-файл.
6. Виводить повідомлення про успішне завершення або про помилки, якщо вони виникли.

## Приклад

Припустимо, у файлі `data.xlsx` є колонки `Date` (дати) та `Value` (Кількість).

**Фільтрація за датою:**

Щоб відфільтрувати дані за останній місяць, достатньо запустити скрипт з налаштуваннями за замовчуванням.

**Фільтрація за датою та значенням:**

Щоб відфільтрувати дані за останні 3 місяці та вивести тільки ті записи, де обсяг продажів більший за 1000, потрібно:

1. Встановити `value_column = "Values"`.
2. Запустити скрипт.
3. Ввести `1000` як порогове значення.
4. Ввести `більші`.

В результаті буде створено файл `filtered_data.xlsx`, який міститиме дані за останні 3 місяці, де значення в колонці `Values` більше 1000.
